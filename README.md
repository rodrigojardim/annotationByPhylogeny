# Annotation By Phylogeny

This tool performs the functional annotation of nucleotide or amino acid sequences based on their position in a phylogenetic tree. The algorithm looks up to two levels above the sequence's position, giving it a new annotation based on its ancestors.

#### Requirements:
1. Python > 3.9
2. Biopython > 1.79

#### How to run:

`python annotByPhylo.py -t <newick file> -f <original fasta file> -a ../data/headers_itol_annotation.txt -o saidaPhylo.fasta -u ../data/Unknown.txt`

#### Format samples:
###### Newick sample file
`(Archaea,(((MMP-9,MMP-2),(MMP-20,(MMP-13,((MMP-18,(MMP-8,MMP-1)),(MMP-12,(MMP-27,((MMP-3,MMP-10)))))))),((MMP-11,(MMP-21,(MMP-25,MMP-17))),(((MMP-14,MMP-15),(MMP-24,MMP-16)),(MMP-19,MMP-28)))));`

###### Fasta sample file
\>Mam_1	tr|A0A024R6R4|A0A024R6R4_HUMANtr|A0A024R6R4|A0A024R6R4_HUMAN 72 kDa type IV collagenase OS=Homo sapiens OX=9606 GN=MMP2 PE=3 SV=1
MEALMARGALTGPLRALCLLGCLLSHAAAAPSPIIKFPGDVAPKTDKELAVQYLNTFYGCPKESCNLFVLKDTLKKMQKFFGLPQTGDLDQNTIETMRKPRCGNPDVANYNFFPRKPKWDKNQITYRIIGYTPDLDPETVDDAFARAFQVWSDVTPLRFSRIHDGEADIMINFGRWEHGDGYPFDGKDGLLAHAFAPGTGVGGDSHFDDDELWTLGEGQVVRVKYGNADGEYCKFPFLFNGKEYNSCTDTGRSDGFLWCSTTYNFEKDGKYGFCPHEALFTMGGNAEGQPCKFPFRFQGTSYDSCTTEGRTDGYRWCGTTEDYDRDKKYGFCPETAMSTVGGNSEGAPCVFPFTFLGNKYESCTSAGRSDGKMWCATTANYDDDRKWGFCPDQGYSLFLVAAHEFGHAMGLEHSQDPGALMAPIYTYTKNFRLSQDDIKGIQELYGASPDIDLGTGPTPTLGPVTPEICKQDIVFDGIAQIRGEIFFFKDRFIWRTVTPRDKPMGPLLVATFWPELPEKIDAVYEAPQEEKAVFFAGNEYWIYSASTLERGYPKPLTSLGLPPDVQRVDAAFNWSKNKKTYIFAGDKFWRYNEVKKKMDPGFPKLIADAWNAIPDNLDAVVDLQGGGHSYFFKGAYYLKLENQSLKSVKFGSIKSDWLGC

\>Mam_2	tr|A0A091DJV3|A0A091DJV3_FUKDAtr|A0A091DJV3|A0A091DJV3_FUKDA Matrix metalloproteinase-9 OS=Fukomys damarensis OX=885580 GN=H920_06188 PE=3 SV=1
MSPWQPLVVLLVLGWCSAAPQRHQPTLVVFPRDLRSSSLTDTQLAEEYLFRYGYTRVADMHMGNKTLRPALLLLQKQLSLPETGELDSATLEAIRTPRCGVPDLGKFQTFEGDLRWHHRNITYWIQNYSEDLPRDLIDDAFARAFAVWSAVTPLTFTRVYGRDADIVIQFGVEEHGDGYPFDGKDGLLAHAFPPGPGIQGDAHFDDEELWTLGKGVVVPTYYGNAGGAPCHFPFTFSGRSYSACTTDGRTDDKPWCSTTADYDADRQYGFCPSESLYTLDGNGEGKPCVFPFTFEGRSYSACTTDGRSDGHRWCATTANYDQDKLYGFCPTRADATVIGGNSAGELCVFPFVFLDKEYSSCTSDGRSDGRLWCATTSNFDTDKKWGFCADQGYSLFLVAAHEFGHALGLDHSSVPEALMYPMYRFLEGSPLNEDDVKGIQHLYGSGPGPEPRPPATTTRKPQPTAPSTVCPTLPPTAGPTGPPAAGPTAPTSAGPTGPPTAGPSLAPTKSFYPVDNPCHVNIFDAIAEIGNYLHFFKDGRYWRFSEGRGRRLQGPFLIADMWPALPTKLDSAFEEPLSKKIFFFSGRQVWVYTGASVLGPRRLDKLGLGSEVTQVTGMISNGGGKALLFSTERFWSFDVKTQRVDSRSVTPVDHMFPGVPLDMYNVFQYREKAYFCQDRFYWRVSFRNEMNQVDEVGYVTYDILQCPEN
</font>

###### Annotation sample file
MMP1,<br/>
MMP2,<br/>
MMP15,<br/>
MMP16,<br/>
MMP17,<br/>

###### Unknown sample file
Mam_1	tr|A0A024R6R4|A0A024R6R4_HUMANtr|A0A024R6R4|A0A024R6R4_HUMAN 72 kDa type IV collagenase OS=Homo sapiens OX=9606 GN=MMP2 PE=3 SV=1 <br/>
Mam_2	tr|A0A091DJV3|A0A091DJV3_FUKDAtr|A0A091DJV3|A0A091DJV3_FUKDA Matrix metalloproteinase-9 OS=Fukomys damarensis OX=885580 GN=H920_06188 PE=3 SV=1
